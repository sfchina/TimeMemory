<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>Time Memory</title>
	<link href="css/ui-lightness/jquery-ui-1.10.4.custom.css" rel="stylesheet">
	<script src="js/lib/jquery-2.1.0.js"></script>
	<script src="js/lib/jquery-ui-1.10.4.custom.js"></script>
	<script src="js/util.js"></script>
	<script>
	$(function(){
		//$( "#timelapse" ).accordion();
		$( "#dialog-link, #icons li" ).hover(
			function() {
				$( this ).addClass( "ui-state-hover" );
			},
			function() {
				$( this ).removeClass( "ui-state-hover" );
			}
		);
		
		var refreshResult=function(){
			$.ajax({url:'/target/captured.json',dataType:'json'
				,error:function(XMLHttpRequest, textStatus, errorThrown){
					
				}
				,success:function(result){
		         if(result.datas){
		        	 var container=$('#container');
		        	 var target='';
		        	 var tempDayId;
		        	 $(result.datas).each(function(index,data){
		        		 var values=data.split('-');
		        		 var dayId=values.slice(0,3).join('-');
		        		 var imgId=data.substr(0,data.length-4);
		        		 if(dayId!=tempDayId){
		        			 tempDayId=dayId;
		        			 target=(target==''?target:'</div>Â¥n')+'<h3>'+dayId+'</h3><div>'
		        		 }
		        		 target=target+'<img src="/target/'+data+'" style="width:80px,height:60px" />'
		        	 });
		        	 target=target+'</div>';
		        	 container.html('<div id="timelapse">'+target+'</div>');
		        	 $("#timelapse").accordion();
		         }
		      	}
				,complete:function(XMLHttpRequest, textStatus){
					
				}
				});
		};
		
		refreshResult();
		var inID=setInterval(refreshResult, 10*1000);
		//clearInterval(inID);
	});
	</script>
		<style>
	body{
		font: 62.5% "Trebuchet MS", sans-serif;
		margin: 50px;
	}
	#icons {
		margin: 0;
		padding: 0;
	}
	#icons li {
		margin: 2px;
		position: relative;
		padding: 4px 0;
		cursor: pointer;
		float: left;
		list-style: none;
	}
	#icons span.ui-icon {
		float: left;
		margin: 0 4px;
	}
	.fakewindowcontain .ui-widget-overlay {
		position: absolute;
	}
	</style>
</head>
<body>
<ul id="icons" class="ui-widget ui-helper-clearfix">
	<li class="ui-state-default ui-corner-all" title=".ui-icon-refresh"><span class="ui-icon ui-icon-refresh"></span></li>
</ul>
<div id="container">
<div id="timelapse">

</div>
</div>


</body>
</html>
